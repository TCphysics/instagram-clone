{"ast":null,"code":"import _slicedToArray from\"/Users/chentang/instagram_clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import'./Post.css';import Avatar from\"@material-ui/core/Avatar\";import{db}from\"./firebase\";import firebase from\"firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Post(_ref){var user=_ref.user,postId=_ref.postId,username=_ref.username,caption=_ref.caption,imageUrl=_ref.imageUrl;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),comment=_useState4[0],setComment=_useState4[1];useEffect(function(){var unsubscribe;if(postId){unsubscribe=db.collection(\"posts\").doc(postId).collection(\"comments\").orderBy('timestamp',\"desc\").onSnapshot(function(snapshot){setComments(snapshot.docs.map(function(doc){return doc.data();}));});}return function(){unsubscribe();};},[postId]);var postComment=function postComment(e){e.preventDefault();db.collection(\"posts\").doc(postId).collection(\"comments\").add({text:comment,username:user.displayName,timestamp:firebase.firestore.FieldValue.serverTimestamp()});setComment(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"post\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post__header\",children:[/*#__PURE__*/_jsx(Avatar,{className:\"post__avatar\",alt:username,src:imageUrl// alt=\"\"\n}),/*#__PURE__*/_jsx(\"h3\",{children:username})]}),/*#__PURE__*/_jsx(\"img\",{className:\"post__image\",src:imageUrl,alt:\"\"}),/*#__PURE__*/_jsxs(\"h4\",{className:\"post__text\",children:[/*#__PURE__*/_jsx(\"strong\",{children:username}),\" \",caption]}),/*#__PURE__*/_jsx(\"div\",{className:\"post__comments\",children:comments.map(function(comment){return/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:comment.username}),\" \",comment.text]});})}),user&&/*#__PURE__*/_jsxs(\"form\",{className:\"post__commentBox\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"post__input\",type:\"text\",placeholder:\"Add a comment here\",value:comment,onChange:function onChange(e){return setComment(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{disabled:!comment,className:\"post__button\",type:\"submit\",onClick:postComment,children:\"Post\"})]})]});}export default Post;","map":{"version":3,"sources":["/Users/chentang/instagram_clone/src/Post.js"],"names":["React","useState","useEffect","Avatar","db","firebase","Post","user","postId","username","caption","imageUrl","comments","setComments","comment","setComment","unsubscribe","collection","doc","orderBy","onSnapshot","snapshot","docs","map","data","postComment","e","preventDefault","add","text","displayName","timestamp","firestore","FieldValue","serverTimestamp","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport './Post.css';\nimport Avatar from \"@material-ui/core/Avatar\";\nimport { db } from \"./firebase\";\nimport firebase from \"firebase\";\n\nfunction Post({ user, postId, username, caption, imageUrl }) {\n    const [comments, setComments] = useState([]);\n    const [comment, setComment] = useState(\"\");\n    useEffect(() => {\n        let unsubscribe;\n        if (postId) {\n          unsubscribe = db\n            .collection(\"posts\")\n            .doc(postId)\n            .collection(\"comments\")\n            .orderBy('timestamp', \"desc\")\n            .onSnapshot((snapshot) => {\n              setComments(snapshot.docs.map((doc) => doc.data()));\n            });\n        }\n        return () => {\n          unsubscribe();\n        };\n      }, [postId]);\n\n      const postComment = (e) => {\n        e.preventDefault();\n        db.collection(\"posts\").doc(postId).collection(\"comments\").add({\n          text: comment,\n          username: user.displayName,\n          timestamp:firebase.firestore.FieldValue.serverTimestamp()\n        });\n        setComment(\"\");\n      };\n\n    return (\n        <div className=\"post\">\n            <div className=\"post__header\">\n                <Avatar\n                    className=\"post__avatar\"\n                    alt={username}\n                    src={imageUrl}\n                // alt=\"\"\n                />\n\n                <h3>{username}</h3>\n            </div>\n\n            <img className=\"post__image\" src={imageUrl} alt=\"\" />\n\n            <h4 className=\"post__text\"><strong>{username}</strong> {caption}</h4>\n\n            <div className=\"post__comments\">\n                {comments.map((comment) => (\n                    <p>\n                        <b>{comment.username}</b> {comment.text}\n                    </p>\n                ))}\n            </div>\n\n            {user && (\n                 <form className=\"post__commentBox\">\n                 <input\n                     className=\"post__input\"\n                     type=\"text\"\n                     placeholder=\"Add a comment here\"\n                     value={comment}\n                     onChange={(e) => setComment(e.target.value)}\n                 />\n                 <button\n                     disabled={!comment}\n                     className=\"post__button\"\n                     type=\"submit\"\n                     onClick={postComment}\n                 >\n                     Post\n                 </button>\n             </form>\n            )}\n        </div>\n    )\n}\n\nexport default Post\n"]},"metadata":{},"sourceType":"module"}